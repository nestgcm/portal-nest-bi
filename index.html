<!DOCTYPE html>
<html lang="pt-br" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEST BI - Inteligência e Estatística</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=Playfair+Display:ital,wght@1,700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <style>
        /* --- VARIÁVEIS --- */
        :root {
            --bg-color: #f0f2f5;
            --header-bg: rgba(255, 255, 255, 0.95);
            --text-primary: #1a252f;
            --text-secondary: #555;
            --accent-color: #003366; 
            --dourado: #b08d57;
            --card-bg: rgba(255, 255, 255, 0.9);
            --border-color: rgba(0, 0, 0, 0.1);
            --shadow: 0 4px 15px rgba(0,0,0,0.05);
            --modal-bg: rgba(255, 255, 255, 0.98);
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --header-bg: rgba(20, 30, 45, 0.95);
            --text-primary: #e0e0e0;
            --text-secondary: #aaa;
            --accent-color: #4a90e2; 
            --dourado: #d4af37;
            --card-bg: rgba(30, 40, 60, 0.8);
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow: 0 10px 30px rgba(0,0,0,0.3);
            --modal-bg: rgba(30, 40, 60, 0.98);
        }

        body {
            font-family: 'Montserrat', sans-serif; margin: 0; height: 100vh; overflow: hidden;
            background-color: var(--bg-color); color: var(--text-primary); transition: 0.3s;
        }

        /* --- BACKGROUND FIXO (PNG) --- */
        #app-bg {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('./imagens/bg-dashboard.png'); 
            background-size: cover; background-position: center; z-index: -2;
            filter: contrast(1.1) brightness(0.9);
        }
        #app-bg::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color); opacity: 0.92; transition: background 0.3s;
        }

        /* --- HEADER E NAVEGAÇÃO --- */
        header.top-bar {
            position: fixed; top: 0; left: 0; width: 100%; height: 70px;
            background: var(--header-bg); backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color); display: flex; justify-content: space-between; align-items: center;
            padding: 0 30px; box-sizing: border-box; z-index: 100; box-shadow: var(--shadow);
        }
        .brand { display: flex; align-items: center; gap: 15px; }
        .brand img { height: 40px; transition: 0.3s; }
        .brand-text h2 { margin: 0; font-size: 18px; color: var(--accent-color); font-weight: 800; }
        .brand-text p { margin: 0; font-size: 11px; color: var(--text-secondary); font-weight: 600; letter-spacing: 1px; }

        .nav-menu { display: flex; align-items: center; gap: 15px; }
        .menu-btn {
            padding: 10px 15px; color: var(--text-secondary); cursor: pointer; border-radius: 6px;
            font-size: 13px; font-weight: 600; display: flex; align-items: center; gap: 6px; transition: 0.3s;
        }
        .menu-btn:hover, .menu-btn.active { background: var(--accent-color); color: white; }
        
        .dropdown { position: relative; }
        .dropdown-content {
            display: none; position: absolute; top: 100%; left: 0;
            background: var(--header-bg); min-width: 220px;
            box-shadow: var(--shadow); border-radius: 8px; padding: 10px 0; border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }
        
        @media (min-width: 769px) {
            .dropdown:hover .dropdown-content { display: block; }
        }

        .dropdown-item {
            padding: 12px 20px; color: var(--text-secondary); cursor: pointer; transition: 0.2s; font-size: 13px; display: flex; align-items: center; gap: 8px; text-decoration: none;
        }
        .dropdown-item:hover { background: var(--accent-color); color: white; }

        .user-actions { display: flex; align-items: center; gap: 20px; margin-left: 20px; }
        .theme-toggle { cursor: pointer; font-size: 22px; color: var(--text-primary); transition: 0.3s; }
        .user-info-header { text-align: right; font-size: 12px; }
        .user-info-header strong { display: block; color: var(--accent-color); font-size: 14px; }
        .btn-sair-menu { color: #e74c3c; font-size: 20px; cursor: pointer; transition: 0.3s; }
        .btn-sair-menu:hover { color: #c0392b; transform: scale(1.1); }

        /* --- RESPONSIVIDADE (MOBILE) --- */
        @media (max-width: 768px) {
            header.top-bar { padding: 0 10px; }
            .brand { gap: 5px; }
            .brand img { height: 32px; } 
            .brand-text { display: none; }
            .user-info-header { display: none; } 
            
            .nav-menu { gap: 2px; }
            .menu-btn { padding: 8px 6px; font-size: 11px; gap: 4px; white-space: nowrap; }
            .menu-btn i { font-size: 16px; }
            
            .user-actions { gap: 10px; margin-left: 5px; }
            .theme-toggle { font-size: 20px; }
            .btn-sair-menu { font-size: 20px; }

            .dropdown-content {
                position: fixed; top: 70px; left: 0; width: 100%; border-radius: 0; 
                box-shadow: 0 10px 20px rgba(0,0,0,0.3); border: none; border-bottom: 1px solid var(--border-color);
            }
            .dropdown.active .dropdown-content { display: block; }
        }

        /* --- MICRO-RESPONSIVIDADE PARA TELAS MUITO PEQUENAS --- */
        @media (max-width: 400px) {
            header.top-bar { padding: 0 5px; }
            .brand img { height: 28px; }
            .nav-menu { gap: 1px; }
            .menu-btn { font-size: 10px; padding: 6px 4px; gap: 2px; }
            .menu-btn i { font-size: 14px; }
            .user-actions { gap: 8px; margin-left: 2px; }
        }

        /* --- CONTEÚDO --- */
        #app-container { opacity: 0; transition: opacity 1s; }
        .content-area { margin-top: 70px; height: calc(100vh - 70px); padding: 30px; box-sizing: border-box; overflow-y: auto; scroll-behavior: smooth; }

        #home-content { max-width: 950px; margin: 30px auto; animation: fadeIn 1s; }
        
        blockquote.quote-destaque {
            font-family: 'Playfair Display', serif; font-size: 26px; color: var(--dourado);
            font-style: italic; margin: 0 0 30px 0; padding: 0 20px; border-left: 4px solid var(--dourado); display: inline-block;
        }
        blockquote footer { font-size: 14px; color: var(--text-secondary); margin-top: 10px; font-family: 'Montserrat', sans-serif; font-style: normal; font-weight: 600; }

        .texto-inspirador { font-size: 16px; line-height: 1.8; color: var(--text-primary); text-align: justify; margin-bottom: 40px; }
        .highlight { color: var(--accent-color); font-weight: 700; }

        /* Seções Gerais */
        .secao-info { margin-bottom: 30px; }
        .secao-info h3, .links-section h3, .badges-section h3, .news-section h3 { 
            color: var(--accent-color); border-bottom: 2px solid var(--dourado); display: inline-block; 
            margin-bottom: 15px; padding-bottom: 5px; text-transform: uppercase; font-size: 18px; letter-spacing: 1px; 
        }
        
        .lista-pilares { list-style: none; padding: 0; }
        .lista-pilares li { margin-bottom: 15px; padding-left: 25px; position: relative; }
        .lista-pilares li::before { content: '\f058'; font-family: "Phosphor-Fill"; position: absolute; left: 0; color: var(--dourado); font-size: 18px; }
        
        /* CARDS DA EQUIPE */
        .equipe-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-top: 20px; }
        .equipe-card { background: var(--card-bg); padding: 25px; border-radius: 12px; border: 1px solid var(--border-color); text-align: left; transition: 0.3s; }
        .equipe-card:hover { transform: translateY(-5px); border-color: var(--dourado); }
        .equipe-card strong { color: var(--accent-color); display: block; font-size: 16px; margin-bottom: 8px; }
        .equipe-card .cargo-principal { font-size: 13px; font-weight: 700; color: var(--text-primary); display: block; text-transform: uppercase; margin-bottom: 5px; }
        .equipe-card .cargo-detalhe { font-size: 11px; color: var(--dourado); font-weight: 700; display: block; text-transform: uppercase; letter-spacing: 0.5px; line-height: 1.4; }
        .equipe-card .formacao { font-size: 12px; color: var(--text-secondary); display: block; margin-top: 8px; font-style: italic; }

        /* NEST EM FOCO (NOTÍCIAS) - Layout Melhorado para múltiplos cards */
        .news-section { margin-top: 50px; margin-bottom: 40px; text-align: left; }
        .news-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
            gap: 20px; 
        }
        .news-card {
            background: var(--card-bg); padding: 25px; border-radius: 12px; text-decoration: none; color: var(--text-primary);
            border: 1px solid var(--border-color); border-top: 4px solid var(--dourado); transition: 0.3s; 
            display: flex; flex-direction: column; justify-content: space-between;
        }
        .news-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); border-color: var(--dourado); }
        .news-card h4 { margin: 0 0 12px 0; color: var(--accent-color); font-size: 16px; line-height: 1.4; font-weight: 700;}
        .news-card p { margin: 0 0 20px 0; font-size: 13px; line-height: 1.6; color: var(--text-secondary); }
        .news-card .news-meta { font-size: 11px; color: var(--dourado); font-weight: 800; text-transform: uppercase; display: flex; align-items: center; gap: 5px; margin-top: auto;}

        /* Links Úteis */
        .links-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 40px; }
        .link-card {
            background: var(--card-bg); padding: 20px; border-radius: 10px; text-decoration: none; color: var(--text-primary);
            border: 1px solid var(--border-color); transition: 0.3s; display: flex; align-items: center; gap: 10px; font-weight: 600; font-size: 14px;
        }
        .link-card i { font-size: 24px; color: var(--dourado); }
        .link-card:hover { transform: translateY(-5px); border-color: var(--dourado); box-shadow: var(--shadow); }

        /* GRID DOS GRUPAMENTOS */
        .badges-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 20px; 
            justify-items: center; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 15px; border: 1px solid var(--border-color);
        }
        .badge-item { width: 80px; height: 80px; display: flex; justify-content: center; align-items: center; transition: 0.3s; filter: grayscale(20%); }
        .badge-item img { max-width: 100%; max-height: 100%; object-fit: contain; filter: drop-shadow(0 4px 6px rgba(0,0,0,0.2)); }
        .badge-item:hover { transform: scale(1.2); filter: grayscale(0%); z-index: 2; }

        /* REDES SOCIAIS (INSTAGRAM TRANSCENDENTAL) */
        .social-area {
            margin-top: 60px;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
        }
        .social-area a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 25px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(176, 141, 87, 0.3);
            border-radius: 50px;
            color: var(--dourado);
            text-decoration: none;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 13px;
            letter-spacing: 2px;
            text-transform: uppercase;
            backdrop-filter: blur(10px);
            transition: all 0.4s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
        }
        .social-area a i {
            font-size: 26px;
            transition: transform 0.4s ease;
        }
        .social-area a:hover {
            background: rgba(176, 141, 87, 0.1);
            border-color: var(--dourado);
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(176, 141, 87, 0.25);
        }
        .social-area a:hover i {
            transform: scale(1.1);
        }

        #iframe-area {
            width: 100%; height: 100%; border-radius: 12px; overflow: hidden;
            background: var(--card-bg); border: 1px solid var(--border-color); display: none; box-shadow: var(--shadow); backdrop-filter: blur(5px);
        }
        iframe { width: 100%; height: 100%; border: none; }
        .oculto { display: none !important; }

        /* --- MODAL DE AVISO --- */
        #custom-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(5px);
            z-index: 20000; display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s;
        }
        .ativo { opacity: 1 !important; pointer-events: all !important; }
        .modal-box {
            background: var(--modal-bg); width: 340px; padding: 30px;
            border-radius: 15px; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            border: 1px solid var(--dourado); transform: scale(0.8); transition: transform 0.3s; max-height: 80vh; overflow-y: auto;
        }
        .ativo .modal-box { transform: scale(1); }
        .modal-icon { font-size: 40px; color: var(--dourado); margin-bottom: 15px; }
        .modal-title { font-size: 18px; font-weight: 700; margin: 0 0 10px 0; color: var(--text-primary); }
        .modal-desc { font-size: 14px; color: var(--text-secondary); margin-bottom: 25px; line-height: 1.5; }
        .btn-modal { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 14px; transition: 0.2s; }
        .btn-confirm { background: var(--accent-color); color: white; }
        .btn-confirm:hover { background: var(--dourado); }
        .btn-cancel { background: transparent; border: 1px solid var(--text-secondary); color: var(--text-primary); margin-right: 10px;}
        .btn-cancel:hover { background: rgba(0,0,0,0.1); }

        /* --- LOGIN --- */
        #login-screen {
            position: fixed; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 9999; background-size: cover; background-position: center; transition: background-image 1s ease-in-out;
        }
        #login-screen::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 20, 40, 0.7); z-index: -1; }
        .login-card {
            background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 40px 50px; border-radius: 15px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); text-align: center; width: 360px; color: white; animation: fadeIn 1s ease-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .logo-img { width: 90px; margin-bottom: 20px; filter: drop-shadow(0 0 10px rgba(255,255,255,0.3)); }
        .titulo-gcm { font-size: 20px; margin: 0; font-weight: 800; letter-spacing: 1px; text-transform: uppercase; line-height: 1.2; }
        .titulo-gerencia { font-size: 13px; margin: 8px 0 2px 0; font-weight: 600; color: #ddd; letter-spacing: 1px; text-transform: uppercase; }
        .titulo-nucleo { font-size: 11px; margin: 0 0 25px 0; color: var(--dourado); font-weight: 700; letter-spacing: 1px; text-transform: uppercase; }
        .input-wrapper { position: relative; width: 100%; margin: 10px 0; }
        .input-group input {
            width: 100%; padding: 15px; background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255,255,255,0.3); border-radius: 8px; color: white;
            font-family: 'Montserrat', sans-serif; font-size: 16px; outline: none; transition: 0.3s; text-align: center; box-sizing: border-box; 
        }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }
        input:focus { border-color: var(--dourado); background: rgba(0,0,0,0.6); }
        .toggle-password { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: rgba(255,255,255,0.7); cursor: pointer; font-size: 20px; }
        .toggle-password:hover { color: white; }
        .btn-login { width: 100%; padding: 15px; margin-top: 20px; background: var(--dourado); border: none; border-radius: 8px; color: white; font-weight: bold; font-size: 16px; cursor: pointer; transition: 0.3s; text-transform: uppercase; letter-spacing: 1px; }
        .btn-login:hover { background: #9e7c48; transform: scale(1.02); }
        .spinner { border: 3px solid rgba(255, 255, 255, 0.3); border-top: 3px solid var(--dourado); border-radius: 50%; width: 25px; height: 25px; animation: spin 1s linear infinite; margin: 20px auto 0; display: none; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div id="app-bg"></div>

    <div id="custom-modal">
        <div class="modal-box">
            <i id="modal-icon" class="ph ph-info modal-icon"></i>
            <h3 id="modal-title" class="modal-title">Título</h3>
            <p id="modal-desc" class="modal-desc">Mensagem aqui.</p>
            <div id="modal-actions" class="modal-actions">
                <button class="btn-modal btn-confirm" onclick="fecharModal('custom-modal')">OK</button>
            </div>
        </div>
    </div>

    <div id="login-screen">
        <div class="login-card">
            <img src="./imagens/brasao_gcm.png" alt="Brasão" class="logo-img" onerror="this.style.display='none'">
            <h1 class="titulo-gcm">GUARDA CIVIL MUNICIPAL</h1>
            <h2 class="titulo-gerencia">GERÊNCIA ESTRATÉGICA DE GESTÃO</h2>
            <h3 class="titulo-nucleo">NÚCLEO DE ESTATÍSTICA E ANÁLISE CRIMINAL</h3>

            <div class="input-group">
                <div class="input-wrapper">
                    <input type="number" id="usuario" placeholder="Matrícula" pattern="\d*">
                </div>
                <div class="input-wrapper">
                    <input type="password" id="senha" placeholder="Senha (CPF) somente números" inputmode="numeric">
                    <i class="ph ph-eye-slash toggle-password" onclick="toggleSenha()"></i>
                </div>
            </div>

            <button id="btnLogin" class="btn-login" onclick="fazerLogin()">Acessar Portal</button>
            <div id="loading" class="spinner"></div>
        </div>
    </div>

    <div id="app-container" class="oculto">
        <header class="top-bar">
            <div class="brand">
                <img src="./imagens/brasao_gcm.png" alt="GCM" onerror="this.style.display='none'">
                <div class="brand-text">
                    <h2>NEST BI</h2>
                    <p>Inteligência que vê. Dados que protegem.</p>
                </div>
            </div>

            <nav class="nav-menu">
                <div class="menu-btn active" onclick="mostrarHome()">
                    <i class="ph ph-house"></i> Início
                </div>
                
                <div class="dropdown" id="dropdown-paineis" onclick="toggleDropdown('dropdown-paineis')">
                    <div class="menu-btn">
                        <i class="ph ph-chart-bar"></i> Painéis <i class="ph ph-caret-down"></i>
                    </div>
                    <div class="dropdown-content">
                        <span class="dropdown-item" onclick="carregarBi('https://app.powerbi.com/view?r=eyJrIjoiNzhjNjNjNTktMWY2NS00MWI2LTk4YTItM2U2MGYwY2ExYjRmIiwidCI6IjNhYzIxOTMxLTdhMjQtNDQzYS1hNjZkLTQ4ODBmNTA4YWYyNyJ9')">GCMs Bahia</span>
                        <span class="dropdown-item" onclick="carregarBi('https://app.powerbi.com/view?r=eyJrIjoiNzk5ODhkYjAtNjEwOS00ODM3LWFmN2EtMmI4ZjdiMDNhODgyIiwidCI6IjNhYzIxOTMxLTdhMjQtNDQzYS1hNjZkLTQ4ODBmNTA4YWYyNyJ9')">Efetivo da GCM</span>
                        <span class="dropdown-item" onclick="carregarBi('https://app.powerbi.com/view?r=eyJrIjoiYWIxY2NkOTctMmM1Ni00Mzk0LTlkZTAtMjJkNjI2MThkMzhjIiwidCI6IjNhYzIxOTMxLTdhMjQtNDQzYS1hNjZkLTQ4ODBmNTA4YWYyNyJ9')">Inspetores</span>
						<span class="dropdown-item" onclick="carregarBi('https://app.powerbi.com/view?r=eyJrIjoiM2ExMzgxNmMtNzgyNy00NzA4LThiOWEtOTA2Mjk0MjhmNDY1IiwidCI6IjNhYzIxOTMxLTdhMjQtNDQzYS1hNjZkLTQ4ODBmNTA4YWYyNyJ9')">Galeria Ex-Superintendentes</span>
                    </div>
                </div>

                <div class="dropdown" id="dropdown-arquivos" onclick="toggleDropdown('dropdown-arquivos')">
                    <div class="menu-btn">
                        <i class="ph ph-folder"></i> Arquivos <i class="ph ph-caret-down"></i>
                    </div>
                    <div class="dropdown-content">
                        <a class="dropdown-item" href="./arquivos/Operaçao Carnaval 2025.pdf" target="_blank"><i class="ph ph-file-pdf"></i> Operação Carnaval 2025</a>
                        <a class="dropdown-item" href="./arquivos/Operação Reveillon 2026.pdf" target="_blank"><i class="ph ph-file-pdf"></i> Operação Reveillon 2026</a>
                    </div>
                </div>

                <div class="menu-btn" onclick="mostrarNoticias()">
                    <i class="ph ph-newspaper"></i> Notícias
                </div>

            </nav>

            <div class="user-actions">
                <i class="ph ph-sun theme-toggle" id="theme-btn" onclick="toggleTheme()"></i>
                <div class="user-info-header">
                    <strong id="display-nome">Usuário</strong>
                    <span id="display-cargo">Cargo</span>
                </div>
                <div class="btn-sair-menu" onclick="confirmarSaida()">
                    <i class="ph ph-sign-out"></i>
                </div>
            </div>
        </header>

        <div class="content-area" id="main-content-area">
            <div id="home-content">
                <div style="text-align: center;">
                    <blockquote class="quote-destaque">
                        QUEM SOMOS
                        <footer>O Núcleo de Estatística (NEST)</footer>
                    </blockquote>
                    <div class="texto-inspirador">
                        <p>O <strong>Núcleo de Estatística (NEST)</strong> é o setor estratégico da Guarda Civil Municipal (GCM), responsável por transformar dados em inteligência para a tomada de decisões. Nossa equipe é composta por servidores de carreira com sólida formação em Estatística, Matemática e Análise de Dados, unindo expertise técnica à visão estratégica do órgão.</p>
                        
                        <div class="secao-info">
                            <h3>Nossa atuação baseia-se em três pilares principais:</h3>
                            <ul class="lista-pilares">
                                <li><strong>Inteligência Estratégica:</strong> Realizamos a análise de dados operacionais e administrativos, além de estudos de evolução histórica que fundamentam o planejamento da GCM.</li>
                                <li><strong>Gestão de Pessoas e Carreira:</strong> Somos responsáveis pelo ranqueamento dos servidores no Plano de Cargos, Carreiras e Vencimentos (PCCV) e pela implementação do sistema de avaliação de desempenho.</li>
                                <li><strong>Inovação e Suporte Interno:</strong> Desenvolvemos ferramentas e planilhas eletrônicas personalizadas para otimizar os processos de diversos setores da instituição.</li>
                            </ul>
                        </div>

                        <p>Além de nossa atuação técnica, o NEST contribui diretamente para a renovação da corporação, ministrando a disciplina de Dados Históricos e Estatísticos nos cursos de formação de novos agentes.</p>

                        <div class="secao-info" style="margin-top: 40px;">
                            <h3>Base Legal</h3>
                            <p style="font-size: 14px;">O Núcleo da estatística (Nest), com as devidas atribuições de acordo o decreto nº 27.731 de 28 de setembro de 2016 em seu Art. 10 – IV b Estatística:</p>
                            <ol style="font-size: 14px; line-height: 1.6; text-align: left;">
                                <li>Articular-se com as diversas esferas do Poder Público e entidades da sociedade civil e realizar os levantamentos estatísticos destes dados e estruturar as informações;</li>
                                <li>Elaborar relatórios contendo o detalhamento e síntese das informações coletadas, identificando áreas e situações críticas ou potencialmente perigosas;</li>
                                <li>Elaborar relatórios comparativos entre os dados de Salvador e demais cidades brasileiras ou de países estrangeiros, de acordo com padrões regulamentados.</li>
                            </ol>
                        </div>

                        <div class="secao-info" style="margin-top: 40px;">
                            <h3>Liderança e Equipe</h3>
                            <div class="equipe-grid">
                                <div class="equipe-card">
                                    <strong>Marcelo Oliveira Silva</strong>
                                    <span class="cargo-principal">Inspetor Geral</span>
                                    <span class="cargo-detalhe">Guarda Civil Municipal<br>Classe Distinta</span>
                                </div>
                                <div class="equipe-card">
                                    <strong>Marcelo Emanuel Silva Gomes</strong>
                                    <span class="cargo-principal">Subinspetor Geral</span>
                                    <span class="cargo-detalhe">Guarda Civil Municipal<br>Classe Distinta</span>
                                </div>
                                <div class="equipe-card">
                                    <strong>Rodrigo do Carmo Souza Vieira</strong>
                                    <span class="cargo-principal">Gerente Estratégico de Gestão</span>
                                    <span class="cargo-detalhe">Guarda Civil Municipal<br>Classe Distinta</span>
                                </div>
                            </div>
                            
                            <h4 style="margin-top:25px; color: var(--dourado); text-transform: uppercase; font-size: 14px; text-align: center;">Equipe Técnica NEST</h4>
                            <div class="equipe-grid">
                                <div class="equipe-card" style="border-left: 4px solid var(--dourado);">
                                    <strong>Antonio Carlos Magalhães Lima</strong>
                                    <span class="cargo-detalhe">Guarda Civil Municipal<br>Classe Distinta</span>
                                    <span class="formacao">Estatístico, Matemático, Cientista de Dados e Instrutor</span>
                                </div>
                                <div class="equipe-card" style="border-left: 4px solid var(--dourado);">
                                    <strong>Sidney de Souza Duarte</strong>
                                    <span class="cargo-detalhe">Guarda Civil Municipal<br>Classe Distinta</span>
                                    <span class="formacao">Matemático e Cientista de Dados</span>
                                </div>
                                <div class="equipe-card" style="border-left: 4px solid var(--dourado);">
                                    <strong>Heber Santos Brito da Silva</strong>
                                    <span class="cargo-detalhe">Guarda Civil Municipal<br>1ª Classe</span>
                                    <span class="formacao">Cientista de Dados e Instrutor</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="news-section" id="secao-noticias">
                    <h3>O NEST em Foco</h3>
                    <div class="news-grid">
                        
                        <a href="https://guardamunicipal.salvador.ba.gov.br/gcm-registra-queda-de-ocorrencias-e-salto-na-identificacao-de-criancas-no-3o-dia-de-carnaval/" target="_blank" class="news-card">
                            <h4>GCM registra queda de ocorrências e salto na identificação de crianças no 3º dia de Carnaval</h4>
                            <p>O uso de inteligência e levantamento de dados operacionais apontam para uma redução significativa de ocorrências e aumento da eficiência na localização de crianças perdidas durante o circuito.</p>
                            <div class="news-meta">
                                <i class="ph ph-link"></i> Portal Oficial GCM Salvador
                            </div>
                        </a>

                        <a href="https://www.instagram.com/p/DRzhzUoEUxl/?utm_source=ig_web_copy_link&igsh=MzRlODBiNWFlZA==" target="_blank" class="news-card">
                            <h4>GCM participa de Conferência Nacional de Dados do IBGE</h4>
                            <p>A Guarda Civil Municipal marcou presença no evento nacional promovido pelo IBGE. O NEST representou a instituição, evidenciando nossa expertise em análise estratégica e gestão de desempenho.</p>
                            <div class="news-meta">
                                <i class="ph ph-instagram-logo"></i> Instagram Oficial GCM
                            </div>
                        </a>

                        <a href="https://agenciadenoticias.salvador.ba.gov.br/index.php/en/49-geral/27697-nucleo-especializado-de-estatistica-auxilia-gcm-na-otimizacao-de-acoes-estrategicas-em-seguranca-publica?highlight=WyJoZWJlciJd" target="_blank" class="news-card">
                            <h4>Núcleo especializado de estatística auxilia GCM na otimização de ações estratégicas</h4>
                            <p>Reportagem especial da Agência de Notícias de Salvador destaca como o NEST transforma dados brutos em inteligência para aprimorar o patrulhamento e as decisões táticas de segurança pública.</p>
                            <div class="news-meta">
                                <i class="ph ph-article"></i> Agência de Notícias de Salvador
                            </div>
                        </a>

                    </div>
                </div>

                <div class="links-section">
                    <h3>Links Úteis</h3>
                    <div class="links-grid">
                        <a href="https://guardamunicipal.salvador.ba.gov.br/" target="_blank" class="link-card">
                            <i class="ph ph-shield-star"></i> Guarda Municipal
                        </a>
                        <a href="https://salvador.ba.gov.br/" target="_blank" class="link-card">
                            <i class="ph ph-buildings"></i> Prefeitura de Salvador
                        </a>
                        <a href="https://transparencia.salvador.ba.gov.br/#" target="_blank" class="link-card">
                            <i class="ph ph-file-magnifying-glass"></i> Portal da Transparência
                        </a>
                        <a href="https://seguranca.sinesp.gov.br/sinesp-seguranca/login.jsf" target="_blank" class="link-card">
                            <i class="ph ph-shield-check"></i> SINESP Segurança
                        </a>
                    </div>
                </div>

                <div class="badges-section">
                    <h3>Grupamentos</h3>
                    <div class="badges-grid" id="badges-grid"></div>
                </div>

                <div id="footer-social" class="social-area">
                    <a href="https://instagram.com/gcmsalvador" target="_blank">
                        <i class="ph ph-instagram-logo"></i> 
                        <span>@gcmsalvador</span>
                    </a>
                </div>
            </div>

            <div id="iframe-area">
                <iframe id="bi-frame" src="" allowFullScreen="true"></iframe>
            </div>
        </div>
    </div>

    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwFWQRpMoHs_gdLzG2fyopq4wgT0rSrrvenMsDWitFz8D4vcqxRQGuL6ldzLHHwy9hq3Q/exec'; 

        // --- RENDERIZAR BRASÕES ---
        const listaGrupamentos = [
            'gepa.png', 'gestg.png', 'maria_da_penha.png', 'gem.png', 
            'goe.png', 'goc.png', 'rondac.png', 'escolar.png', 
            'cprev.png', 'gat.png'
        ];

        function renderizarGrupamentos() {
            const container = document.getElementById('badges-grid');
            container.innerHTML = "";
            listaGrupamentos.forEach(imgNome => {
                const div = document.createElement('div');
                div.className = 'badge-item';
                div.innerHTML = `<img src="./imagens/${imgNome}" alt="Grupamento" onerror="this.style.display='none'">`;
                container.appendChild(div);
            });
        }
        document.addEventListener("DOMContentLoaded", renderizarGrupamentos);

        // --- LÓGICA DE SENHA E LOGIN ---
        document.getElementById('senha').addEventListener('input', function (e) {
            this.value = this.value.replace(/[^0-9]/g, '');
        });

        function toggleSenha() {
            const inputSenha = document.getElementById('senha');
            const icone = document.querySelector('.toggle-password');
            if (inputSenha.type === 'password') {
                inputSenha.type = 'text';
                icone.classList.replace('ph-eye-slash', 'ph-eye');
            } else {
                inputSenha.type = 'password';
                icone.classList.replace('ph-eye', 'ph-eye-slash');
            }
        }

        function fazerLogin() {
            const user = document.getElementById('usuario').value.trim();
            const pass = document.getElementById('senha').value.trim();
            const btn = document.getElementById('btnLogin');
            const spinner = document.getElementById('loading');

            if (!user || !pass) { exibirModal("Atenção", "Por favor, preencha a matrícula e a senha.", "erro"); return; }

            btn.style.display = 'none';
            spinner.style.display = 'block';

            fetch(scriptURL + '?user=' + encodeURIComponent(user) + '&pass=' + encodeURIComponent(pass))
            .then(res => res.json())
            .then(data => {
                if (data.status === 'sucesso') {
                    document.getElementById('display-nome').innerText = data.nome;
                    document.getElementById('display-cargo').innerText = data.cargo;
                    document.getElementById('login-screen').style.opacity = '0';
                    setTimeout(() => {
                        document.getElementById('login-screen').classList.add('oculto');
                        document.getElementById('app-container').classList.remove('oculto');
                        document.getElementById('app-container').style.opacity = '1';
                    }, 800);
                } else {
                    btn.style.display = 'block';
                    spinner.style.display = 'none';
                    exibirModal("Acesso Negado", "Matrícula ou senha incorretos.", "erro");
                }
            })
            .catch(e => {
                console.error(e);
                btn.style.display = 'block';
                spinner.style.display = 'none';
                exibirModal("Erro de Conexão", "Não foi possível conectar ao servidor.", "erro");
            });
        }

        // --- NAVEGAÇÃO E MODAIS ---
        function toggleDropdown(id) {
            if (window.innerWidth <= 768) {
                document.querySelectorAll('.dropdown').forEach(d => {
                    if(d.id !== id) d.classList.remove('active');
                });
                document.getElementById(id).classList.toggle('active');
            }
        }

        function exibirModal(titulo, mensagem, tipo) {
            const modal = document.getElementById('custom-modal');
            const icon = document.getElementById('modal-icon');
            document.getElementById('modal-title').innerText = titulo;
            document.getElementById('modal-desc').innerText = mensagem;
            
            if (tipo === 'erro') {
                icon.className = 'ph ph-warning-circle modal-icon';
                icon.style.color = '#e74c3c';
            } else {
                icon.className = 'ph ph-info modal-icon';
                icon.style.color = 'var(--dourado)';
            }
            modal.classList.add('ativo');
        }

        function fecharModal(id) { document.getElementById(id).classList.remove('ativo'); }

        function confirmarSaida() {
            const modal = document.getElementById('custom-modal');
            document.getElementById('modal-title').innerText = "Encerrar Sessão";
            document.getElementById('modal-desc').innerText = "Tem certeza que deseja sair do sistema?";
            const actions = document.getElementById('modal-actions');
            actions.innerHTML = `
                <button class="btn-modal btn-cancel" onclick="fecharModal('custom-modal')">Cancelar</button>
                <button class="btn-modal btn-confirm" onclick="location.reload()">Sair</button>
            `;
            modal.classList.add('ativo');
        }

        function mostrarHome() {
            document.getElementById('iframe-area').style.display = 'none';
            document.getElementById('home-content').style.display = 'block';
            document.getElementById('bi-frame').src = "";
            document.querySelectorAll('.menu-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector('.menu-btn i.ph-house').parentElement.classList.add('active');
            
            // Fecha dropdowns abertos
            document.querySelectorAll('.dropdown').forEach(d => d.classList.remove('active'));
            
            // Traz scroll pro topo suavemente
            document.getElementById('main-content-area').scrollTo({top: 0, behavior: 'smooth'});
        }

        function carregarBi(link) {
            document.getElementById('home-content').style.display = 'none';
            document.getElementById('iframe-area').style.display = 'block';
            document.getElementById('bi-frame').src = link;
            document.querySelectorAll('.menu-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.dropdown').forEach(d => d.classList.remove('active'));
        }

        function mostrarNoticias() {
            mostrarHome();
            setTimeout(() => {
                const section = document.getElementById('secao-noticias');
                if(section) {
                    section.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }, 100);
        }

        // --- ROTAÇÃO DE FUNDO (PNG) ---
        function toggleTheme() {
            const html = document.documentElement;
            const themeBtn = document.getElementById('theme-btn');
            const newTheme = html.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
            html.setAttribute('data-theme', newTheme);
            themeBtn.classList.replace(newTheme === 'dark' ? 'ph-sun' : 'ph-moon', newTheme === 'dark' ? 'ph-moon' : 'ph-sun');
            localStorage.setItem('nest-theme', newTheme);
        }
        const savedTheme = localStorage.getItem('nest-theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        if (savedTheme === 'dark') { document.getElementById('theme-btn').classList.replace('ph-sun', 'ph-moon'); }

        const loginImages = ['./imagens/bg-login.png', './imagens/bg-index.png', './imagens/bg-dashboard.png'];
        let currentImageIndex = 0;
        const loginScreen = document.getElementById('login-screen');
        function rotateLoginBackground() {
            let img = new Image();
            img.src = loginImages[currentImageIndex];
            img.onload = function() { loginScreen.style.backgroundImage = `url('${loginImages[currentImageIndex]}')`; }
            currentImageIndex = (currentImageIndex + 1) % loginImages.length;
        }
        rotateLoginBackground();
        setInterval(rotateLoginBackground, 5000);

        document.getElementById('senha').addEventListener("keypress", function(event) {
            if (event.key === "Enter") fazerLogin();
        });
    </script>
</body>
</html>
